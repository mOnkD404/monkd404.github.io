<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Android WebView DrawFn 相关 | DTech</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在 chromium 的较高版本 webview 中，适配了android Q 的 vulkan 渲染。在 webview 的历史实现中，由于和 chrome 架构差异，需要使用 DrawGL 相关方法在 android view 中绘制内容。 chrome 浏览器是完全独立的app，因此完全实现了自己的渲染，没有用android的 view 框架；webview 由于要作为一个 view 嵌入">
<meta property="og:type" content="article">
<meta property="og:title" content="Android WebView DrawFn 相关">
<meta property="og:url" content="https://bathingsun.xyz/2020/09/22/Android-WebView-DrawFn-%E7%9B%B8%E5%85%B3/index.html">
<meta property="og:site_name" content="DTech">
<meta property="og:description" content="在 chromium 的较高版本 webview 中，适配了android Q 的 vulkan 渲染。在 webview 的历史实现中，由于和 chrome 架构差异，需要使用 DrawGL 相关方法在 android view 中绘制内容。 chrome 浏览器是完全独立的app，因此完全实现了自己的渲染，没有用android的 view 框架；webview 由于要作为一个 view 嵌入">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-09-22T05:05:17.000Z">
<meta property="article:modified_time" content="2020-12-18T10:10:24.285Z">
<meta property="article:author" content="MonkD404">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="DTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">DTech</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://bathingsun.xyz"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Android-WebView-DrawFn-相关" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/22/Android-WebView-DrawFn-%E7%9B%B8%E5%85%B3/" class="article-date">
  <time datetime="2020-09-22T05:05:17.000Z" itemprop="datePublished">2020-09-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android WebView DrawFn 相关
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在 chromium 的较高版本 webview 中，适配了android Q 的 vulkan 渲染。<br>在 webview 的历史实现中，由于和 chrome 架构差异，需要使用 DrawGL 相关方法在 android view 中绘制内容。</p>
<p>chrome 浏览器是完全独立的app，因此完全实现了自己的渲染，没有用android的 view 框架；webview 由于要作为一个 view 嵌入 app，所以必须依托于 android 的 view 对象，webview 通过反射调用 android.view.DisplayListCanvas 的 drawGLFunctor 方法实现绘制。<br>在最新的代码中，为了使用 android Q 的 vulkan 框架，webview 使用了新的实现方法用于调用vulkan。</p>
<h2 id="plat-support"><a href="#plat-support" class="headerlink" title="plat_support"></a>plat_support</h2><p>plat_support 是个webview依赖的系统库，实现了webview的创建functor的方法，由于是平台相关，所以实在framework中提供。<br><a target="_blank" rel="noopener" href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/native/webview/plat_support/">https://cs.android.com/android/platform/superproject/+/master:frameworks/base/native/webview/plat_support/</a><br>在plat_support创建时会向一个webview的类中注册几个native方法，webview通过使用这些方法，创建系统版本对应的functor，如创建DrawGLFunctor的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const char kClassName[] &#x3D; &quot;com&#x2F;android&#x2F;webview&#x2F;chromium&#x2F;DrawGLFunctor&quot;;</span><br><span class="line">const JNINativeMethod kJniMethods[] &#x3D; &#123;</span><br><span class="line">    &#123; &quot;nativeCreateGLFunctor&quot;, &quot;(J)J&quot;,</span><br><span class="line">        reinterpret_cast&lt;void*&gt;(CreateGLFunctor) &#125;,</span><br><span class="line">    &#123; &quot;nativeDestroyGLFunctor&quot;, &quot;(J)V&quot;,</span><br><span class="line">        reinterpret_cast&lt;void*&gt;(DestroyGLFunctor) &#125;,</span><br><span class="line">    &#123; &quot;nativeSetChromiumAwDrawGLFunction&quot;, &quot;(J)V&quot;,</span><br><span class="line">        reinterpret_cast&lt;void*&gt;(SetChromiumAwDrawGLFunction) &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>以及创建能使用vulkan的DrawFunctor的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">char kClassName[]</span><br><span class="line">const JNINativeMethod kJniMethods[] &#x3D; &#123;</span><br><span class="line">    &#123;&quot;nativeGetFunctionTable&quot;, &quot;()J&quot;,</span><br><span class="line">     reinterpret_cast&lt;void*&gt;(GetDrawFnFunctionTable)&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在创建DrawFunctor的table中，看指向create_functor的函数指针，指向了真正的创建函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">int CreateFunctor(void* data, AwDrawFnFunctorCallbacks* functor_callbacks) &#123;</span><br><span class="line">  static bool callbacks_initialized &#x3D; false;</span><br><span class="line">  static uirenderer::WebViewFunctorCallbacks webview_functor_callbacks &#x3D; &#123;</span><br><span class="line">      .onSync &#x3D; &amp;onSync,</span><br><span class="line">      .onContextDestroyed &#x3D; &amp;onContextDestroyed,</span><br><span class="line">      .onDestroyed &#x3D; &amp;onDestroyed,</span><br><span class="line">  &#125;;</span><br><span class="line">  if (!callbacks_initialized) &#123;</span><br><span class="line">    switch (uirenderer::WebViewFunctor_queryPlatformRenderMode()) &#123;</span><br><span class="line">      case uirenderer::RenderMode::OpenGL_ES:</span><br><span class="line">        webview_functor_callbacks.gles.draw &#x3D; &amp;draw_gl;</span><br><span class="line">        break;</span><br><span class="line">      case uirenderer::RenderMode::Vulkan:</span><br><span class="line">        webview_functor_callbacks.vk.initialize &#x3D; &amp;initializeVk;</span><br><span class="line">        webview_functor_callbacks.vk.draw &#x3D; &amp;drawVk;</span><br><span class="line">        webview_functor_callbacks.vk.postDraw &#x3D; &amp;postDrawVk;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    callbacks_initialized &#x3D; true;</span><br><span class="line">  &#125;</span><br><span class="line">  SupportData* support &#x3D; new SupportData&#123;</span><br><span class="line">      .data &#x3D; data,</span><br><span class="line">      .callbacks &#x3D; *functor_callbacks,</span><br><span class="line">  &#125;;</span><br><span class="line">  int functor &#x3D; uirenderer::WebViewFunctor_create(</span><br><span class="line">      support, webview_functor_callbacks,</span><br><span class="line">      uirenderer::WebViewFunctor_queryPlatformRenderMode());</span><br><span class="line">  if (functor &lt;&#x3D; 0) delete support;</span><br><span class="line">  return functor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首次初始化时会根据平台相关特性，选择使用opengl还是vulkan。</p>
<h2 id="WebView-调用DrawGLFunctor过程"><a href="#WebView-调用DrawGLFunctor过程" class="headerlink" title="WebView 调用DrawGLFunctor过程"></a>WebView 调用DrawGLFunctor过程</h2><p>这部分网上分析很多，不详细记录了，大概就是AwContents.onDraw的时候反射调用canvas里一个私有的方法。webview 通过周期地触发InProcessCommandBuffer::Flush方法，触发renderThread的合成。</p>
<p>需要注意的是，chrome和 webview 在渲染上最大的区别就是，command buffer service线程，在chrome上生产者和消费者都在同一个service线程，在webview上，生产者和消费者在不同的线程，因为webview的渲染不是chromium自己管理的，他只输出EGLImage，交给android系统的RenderThread处理 ConsumeTexture。于是，webview使用MailboxManagerSync，而chrome使用MailboxManagerImpl，webview使用的是加锁多线程共享的方式实现。<br>附生产和消费texture的调用栈：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">(gdb) bt</span><br><span class="line">#0  gpu::gles2::MailboxManagerSync::ConsumeTexture () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;mailbox_manager_sync.cc:194</span><br><span class="line">#1  0xcbaa0f80 in gpu::gles2::GLES2DecoderImpl::DoCreateAndConsumeTextureINTERNAL () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;gles2_cmd_decoder.cc:18454</span><br><span class="line">#2  0xcba85898 in gpu::gles2::GLES2DecoderImpl::HandleCreateAndConsumeTextureINTERNALImmediate () at ..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;gles2_cmd_decoder_autogen.h:4946</span><br><span class="line">#3  0xcba8f6a0 in gpu::gles2::GLES2DecoderImpl::DoCommandsImpl&lt;false&gt; () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;gles2_cmd_decoder.cc:5932</span><br><span class="line">#4  0xcb9bdc54 in gpu::CommandBufferService::Flush () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;command_buffer_service.cc:69</span><br><span class="line">#5  0xcbb2163a in gpu::InProcessCommandBuffer::FlushOnGpuThread () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;in_process_command_buffer.cc:913</span><br><span class="line">#6  0xca515508 in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#7  0xca52ffde in base::internal::FunctorTraits&lt;void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), void&gt;::Invoke&lt;void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;, base::OnceCallback&lt;void ()&gt; &gt;(void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;&amp;&amp;, base::OnceCallback&lt;void ()&gt;&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:499</span><br><span class="line">#8  base::internal::InvokeHelper&lt;true, void&gt;::MakeItSo&lt;void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;, base::OnceCallback&lt;void ()&gt; &gt;(void (android_webview::AwCookieStoreWrapper::*&amp;&amp;)(base::OnceCallback&lt;void ()&gt;), base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;&amp;&amp;, base::OnceCallback&lt;void ()&gt;&amp;&amp;) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:619</span><br><span class="line">#9  base::internal::Invoker&lt;base::internal::BindState&lt;void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;, base::OnceCallback&lt;void ()&gt; &gt;, void ()&gt;::RunImpl&lt;void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), std::__1::tuple&lt;base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;, base::OnceCallback&lt;void ()&gt; &gt;, 0u, 1u&gt;(void (android_webview::AwCookieStoreWrapper::*&amp;&amp;)(base::OnceCallback&lt;void ()&gt;), std::__1::tuple&lt;base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;, base::OnceCallback&lt;void ()&gt; &gt;&amp;&amp;, std::__1::integer_sequence&lt;unsigned int, 0u, 1u&gt;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:672</span><br><span class="line">#10 base::internal::Invoker&lt;base::internal::BindState&lt;void (android_webview::AwCookieStoreWrapper::*)(base::OnceCallback&lt;void ()&gt;), base::WeakPtr&lt;android_webview::AwCookieStoreWrapper&gt;, base::OnceCallback&lt;void ()&gt; &gt;, void ()&gt;::RunOnce(base::internal::BindStateBase*) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:641</span><br><span class="line">#11 0xca515508 in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#12 0xca5484bc in android_webview::TaskForwardingSequence::RunTask(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;deferred_gpu_command_service.cc:108</span><br><span class="line">#13 0xca548544 in base::internal::FunctorTraits&lt;void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), void&gt;::Invoke&lt;void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;, base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int&gt;(void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;&amp;&amp;, base::OnceCallback&lt;void ()&gt;&amp;&amp;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;&amp;&amp;, unsigned int&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:499</span><br><span class="line">#14 base::internal::InvokeHelper&lt;true, void&gt;::MakeItSo&lt;void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;, base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int&gt;(void (android_webview::TaskForwardingSequence::*&amp;&amp;)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;&amp;&amp;, base::OnceCallback&lt;void ()&gt;&amp;&amp;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;&amp;&amp;, unsigned int&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:619</span><br><span class="line">#15 base::internal::Invoker&lt;base::internal::BindState&lt;void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;, base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int&gt;, void ()&gt;::RunImpl&lt;void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), std::__1::tuple&lt;base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;, base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int&gt;, 0u, 1u, 2u, 3u&gt;(void (android_webview::TaskForwardingSequence::*&amp;&amp;)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), std::__1::tuple&lt;base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;, base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int&gt;&amp;&amp;, std::__1::integer_sequence&lt;unsigned int, 0u, 1u, 2u, 3u&gt;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:672</span><br><span class="line">#16 base::internal::Invoker&lt;base::internal::BindState&lt;void (android_webview::TaskForwardingSequence::*)(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int), base::WeakPtr&lt;android_webview::TaskForwardingSequence&gt;, base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;, unsigned int&gt;, void ()&gt;::RunOnce(base::internal::BindStateBase*) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:641</span><br><span class="line">#17 0xca515508 in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#18 0xca547f16 in android_webview::DeferredGpuCommandService::RunTasks () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;deferred_gpu_command_service.cc:243</span><br><span class="line">#19 0xca547ec8 in android_webview::DeferredGpuCommandService::ScheduleTask(base::OnceCallback&lt;void ()&gt;, bool) () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;deferred_gpu_command_service.cc:188</span><br><span class="line">#20 0xca5483ac in android_webview::TaskForwardingSequence::ScheduleTask(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;deferred_gpu_command_service.cc:77</span><br><span class="line">#21 0xcbb2156e in gpu::InProcessCommandBuffer::ScheduleGpuTask(base::OnceCallback&lt;void ()&gt;, std::__1::vector&lt;gpu::SyncToken, std::__1::allocator&lt;gpu::SyncToken&gt; &gt;) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;in_process_command_buffer.cc:849</span><br><span class="line">#22 0xcbb219a6 in gpu::InProcessCommandBuffer::Flush () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;in_process_command_buffer.cc:977</span><br><span class="line">#23 0xca7a9b84 in gpu::CommandBufferHelper::Flush () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;client&#x2F;cmd_buffer_helper.cc:182</span><br><span class="line">#24 0xcb8b2800 in gpu::gles2::GLES2Implementation::FlushHelper () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;client&#x2F;gles2_implementation.cc:1388</span><br><span class="line">#25 0xcb8b2a7c in gpu::gles2::GLES2Implementation::IssueShallowFlush () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;client&#x2F;gles2_implementation.cc:1378</span><br><span class="line">#26 0xca549968 in android_webview::ParentOutputSurface::SwapBuffers () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;parent_output_surface.cc:52</span><br><span class="line">#27 0xcba317dc in viz::GLRenderer::SwapBuffers () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;gl_renderer.cc:2901</span><br><span class="line">#28 0xcba25d3a in viz::Display::DrawAndSwap () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;display.cc:523</span><br><span class="line">#29 0xca54bba6 in android_webview::SurfacesInstance::DrawAndSwap () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;surfaces_instance.cc:239</span><br><span class="line">#30 0xca548fc8 in android_webview::HardwareRenderer::Draw () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;hardware_renderer.cc:182</span><br><span class="line">#31 0xca54a00c in android_webview::RenderThreadManager::DrawOnRT () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;render_thread_manager.cc:195</span><br><span class="line">#32 0xca544be2 in android_webview::AwGLFunctor::DrawGL () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_gl_functor.cc:119</span><br><span class="line">---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---</span><br><span class="line">#33 DrawGLFunction () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_gl_functor.cc:27</span><br><span class="line">#34 0xec21d328 in android::(anonymous namespace)::DrawGLFunctor::operator()(int, void*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libwebviewchromium_plat_support.so</span><br><span class="line">#35 0xf26fc6de in android::uirenderer::skiapipeline::GLFunctorDrawable::onDraw(SkCanvas*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#36 0xf29b84b6 in SkDrawable::draw(SkCanvas*, SkMatrix const*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#37 0xf29b8ac2 in SkLiteDL::draw(SkCanvas*) const () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#38 0xf29a07e0 in android::uirenderer::skiapipeline::RenderNodeDrawable::drawContent(SkCanvas*) const () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#39 0xf29a0af6 in android::uirenderer::skiapipeline::RenderNodeDrawable::forceDraw(SkCanvas*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#40 0xf2703d3e in android::uirenderer::skiapipeline::SkiaPipeline::renderLayersImpl(android::uirenderer::LayerUpdateQueue const&amp;, bool, bool) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#41 0xf29d3d1a in android::uirenderer::skiapipeline::SkiaPipeline::renderFrame(android::uirenderer::LayerUpdateQueue const&amp;, SkRect const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, bool, bool, android::uirenderer::Rect const&amp;, sk_sp&lt;SkSurface&gt;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#42 0xf29d33de in android::uirenderer::skiapipeline::SkiaOpenGLPipeline::draw(android::uirenderer::renderthread::Frame const&amp;, SkRect const&amp;, SkRect const&amp;, android::uirenderer::FrameBuilder::LightGeometry const&amp;, android::uirenderer::LayerUpdateQueue*, android::uirenderer::Rect const&amp;, bool, bool, android::uirenderer::BakedOpRenderer::LightInfo const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, android::uirenderer::FrameInfoVisualizer*) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#43 0xf270c42c in android::uirenderer::renderthread::CanvasContext::draw() () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#44 0xf29d6b08 in std::__1::__function::__func&lt;android::uirenderer::renderthread::DrawFrameTask::postAndWait()::$_0, std::__1::allocator&lt;android::uirenderer::renderthread::DrawFrameTask::postAndWait()::$_0&gt;, void ()&gt;::operator() () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#45 0xf299fb30 in android::uirenderer::WorkQueue::process() () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#46 0xf271519e in android::uirenderer::renderthread::RenderThread::threadLoop() () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#47 0xf132f088 in android::Thread::_threadLoop(void*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libutils.so</span><br><span class="line">#48 0xf1ea940a in __pthread_start(void*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libc.so</span><br><span class="line">#49 0xf1e630ce in __start_thread () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libc.so</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(gdb) bt</span><br><span class="line">#0  gpu::gles2::MailboxManagerSync::ProduceTexture () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;mailbox_manager_sync.cc:226</span><br><span class="line">#1  0xcbae0318 in gpu::SharedImageBackingPassthroughGLTexture::ProduceLegacyMailbox ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_backing_factory_gl_texture.cc:593</span><br><span class="line">#2  0xcbad10b6 in gpu::SharedImageRepresentationFactoryRef::ProduceLegacyMailbox () at ..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_representation.h:73</span><br><span class="line">#3  gpu::SharedImageFactory::RegisterBacking () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_factory.cc:287</span><br><span class="line">#4  0xcbad0f96 in gpu::SharedImageFactory::CreateSharedImage () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_factory.cc:117</span><br><span class="line">#5  0xcbb2bdf4 in gpu::SharedImageStub::OnCreateSharedImage () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;shared_image_stub.cc:99</span><br><span class="line">#6  0xcbb2baf4 in base::DispatchToMethodImpl&lt;gpu::SharedImageStub*, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;, 0u&gt;(gpu::SharedImageStub* const&amp;, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;&amp;&amp;, std::__1::integer_sequence&lt;unsigned int, 0u&gt;) () at ..&#x2F;..&#x2F;base&#x2F;tuple.h:52</span><br><span class="line">#7  base::DispatchToMethod&lt;gpu::SharedImageStub*, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt; &gt;(gpu::SharedImageStub* const&amp;, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;tuple.h:60</span><br><span class="line">#8  IPC::DispatchToMethod&lt;gpu::SharedImageStub, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), void, std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt; &gt;(gpu::SharedImageStub*, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), void*, std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;&amp;&amp;) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;ipc&#x2F;ipc_message_templates.h:51</span><br><span class="line">#9  IPC::MessageT&lt;GpuChannelMsg_CreateSharedImage_Meta, std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;, void&gt;::Dispatch&lt;gpu::SharedImageStub, gpu::SharedImageStub, void, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;)&gt; () at ..&#x2F;..&#x2F;ipc&#x2F;ipc_message_templates.h:146</span><br><span class="line">#10 gpu::SharedImageStub::OnMessageReceived () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;shared_image_stub.cc:69</span><br><span class="line">#11 0xcbb280b8 in gpu::GpuChannel::HandleMessageHelper () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel.cc:597</span><br><span class="line">#12 0xcbb273b0 in gpu::GpuChannel::HandleMessage () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel.cc:560</span><br><span class="line">#13 0xcb9bf9b6 in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#14 gpu::Scheduler::RunNextTask () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;scheduler.cc:527</span><br><span class="line">#15 0xcb1088c8 in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#16 base::TaskAnnotator::RunTask () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;task&#x2F;common&#x2F;task_annotator.cc:114</span><br><span class="line">#17 base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;task&#x2F;sequence_manager&#x2F;thread_controller_with_message_pump_impl.cc:363</span><br><span class="line">#18 0xcb10855c in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoSomeWork () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;task&#x2F;sequence_manager&#x2F;thread_controller_with_message_pump_impl.cc:214</span><br><span class="line">#19 0xcb108d9c in non-virtual thunk to base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoSomeWork() () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;time&#x2F;time_now_posix.cc:52</span><br><span class="line">#20 0xcb0e6e9c in base::MessagePumpDefault::Run () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;message_loop&#x2F;message_pump_default.cc:39</span><br><span class="line">#21 0xcb1090fe in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::Run () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;task&#x2F;sequence_manager&#x2F;thread_controller_with_message_pump_impl.cc:448</span><br><span class="line">#22 0xcb0f36de in base::RunLoop::RunWithTimeout () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;run_loop.cc:161</span><br><span class="line">#23 0xcb119ab2 in base::Thread::ThreadMain () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;threading&#x2F;thread.cc:312</span><br><span class="line">#24 0xcb13b010 in base::(anonymous namespace)::ThreadFunc () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;threading&#x2F;platform_thread_posix.cc:81</span><br><span class="line">#25 0xf1ea940a in __pthread_start(void*) () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libc.so</span><br><span class="line">#26 0xf1e630ce in __start_thread () from &#x2F;tmp&#x2F;adb-gdb-libs-803fd342&#x2F;system&#x2F;lib&#x2F;libc.so</span><br></pre></td></tr></table></figure>
<p>RasterTileWorker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#0  gpu::SharedImageInterfaceProxy::CreateSharedImage () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;client&#x2F;shared_image_interface_proxy.cc:63</span><br><span class="line">#1  0xc2ae3952 in cc::(anonymous namespace)::RasterizeSourceOOP () at .&#x2F;..&#x2F;..&#x2F;cc&#x2F;raster&#x2F;gpu_raster_buffer_provider.cc:142</span><br><span class="line">#2  cc::GpuRasterBufferProvider::PlaybackOnWorkerThreadInternal () at .&#x2F;..&#x2F;..&#x2F;cc&#x2F;raster&#x2F;gpu_raster_buffer_provider.cc:546</span><br><span class="line">#3  cc::GpuRasterBufferProvider::PlaybackOnWorkerThread () at .&#x2F;..&#x2F;..&#x2F;cc&#x2F;raster&#x2F;gpu_raster_buffer_provider.cc:470</span><br><span class="line">#4  cc::GpuRasterBufferProvider::RasterBufferImpl::Playback () at .&#x2F;..&#x2F;..&#x2F;cc&#x2F;raster&#x2F;gpu_raster_buffer_provider.cc:325</span><br><span class="line">#5  0xc2b4b6c8 in cc::(anonymous namespace)::RasterTaskImpl::RunOnWorkerThread () at .&#x2F;..&#x2F;..&#x2F;cc&#x2F;tiles&#x2F;tile_manager.cc:160</span><br><span class="line">#6  0xc365e4d2 in content::CategorizedWorkerPool::RunTaskInCategoryWithLockAcquired () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;renderer&#x2F;categorized_worker_pool.cc:400</span><br><span class="line">#7  content::CategorizedWorkerPool::RunTaskWithLockAcquired () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;renderer&#x2F;categorized_worker_pool.cc:378</span><br><span class="line">#8  content::CategorizedWorkerPool::Run () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;renderer&#x2F;categorized_worker_pool.cc:260</span><br><span class="line">#9  content::(anonymous namespace)::CategorizedWorkerPoolThread::Run () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;renderer&#x2F;categorized_worker_pool.cc:55</span><br><span class="line">#10 0xc21896a6 in base::SimpleThread::ThreadMain () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;threading&#x2F;simple_thread.cc:80</span><br><span class="line">#11 0xc21ad234 in base::(anonymous namespace)::ThreadFunc () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;threading&#x2F;platform_thread_posix.cc:81</span><br></pre></td></tr></table></figure>
<p>InProcGPUThread</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#0  gpu::SharedImageBackingFactoryGLTexture::MakeBacking ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_backing_factory_gl_texture.cc:1222</span><br><span class="line">#1  0xc2d72960 in gpu::SharedImageBackingFactoryGLTexture::CreateSharedImage ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_backing_factory_gl_texture.cc:1052</span><br><span class="line">#2  0xc2d72442 in gpu::SharedImageBackingFactoryGLTexture::CreateSharedImage ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_backing_factory_gl_texture.cc:857</span><br><span class="line">#3  0xc2d74fe6 in gpu::SharedImageFactory::CreateSharedImage ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_factory.cc:115</span><br><span class="line">#4  0xc2dd1540 in gpu::SharedImageStub::OnCreateSharedImage () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;shared_image_stub.cc:99</span><br><span class="line">#5  0xc2dd1250 in base::DispatchToMethodImpl&lt;gpu::SharedImageStub*, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;, 0u&gt;(gpu::SharedImageStub* const&amp;, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;&amp;&amp;, std::__1::integer_sequence&lt;unsigned int, 0u&gt;) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;base&#x2F;tuple.h:52</span><br><span class="line">#6  base::DispatchToMethod&lt;gpu::SharedImageStub*, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt; &gt;(gpu::SharedImageStub* const&amp;, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;tuple.h:60</span><br><span class="line">#7  IPC::DispatchToMethod&lt;gpu::SharedImageStub, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), void, std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt; &gt;(gpu::SharedImageStub*, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;), void*, std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;&amp;&amp;) () at ..&#x2F;..&#x2F;ipc&#x2F;ipc_message_templates.h:51</span><br><span class="line">#8  IPC::MessageT&lt;GpuChannelMsg_CreateSharedImage_Meta, std::__1::tuple&lt;GpuChannelMsg_CreateSharedImage_Params&gt;, void&gt;::Dispatch&lt;gpu::SharedImageStub, gpu::SharedImageStub, void, void (gpu::SharedImageStub::*)(GpuChannelMsg_CreateSharedImage_Params const&amp;)&gt; ()</span><br><span class="line">    at ..&#x2F;..&#x2F;ipc&#x2F;ipc_message_templates.h:146</span><br><span class="line">#9  gpu::SharedImageStub::OnMessageReceived () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;shared_image_stub.cc:69</span><br><span class="line">#10 0xc2dcd8b0 in gpu::GpuChannel::HandleMessageHelper () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel.cc:614</span><br><span class="line">#11 0xc2dccbbc in gpu::GpuChannel::HandleMessage () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel.cc:570</span><br><span class="line">#12 0xc2c337ce in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#13 gpu::Scheduler::RunNextTask () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;scheduler.cc:527</span><br><span class="line">#14 0xc2245d46 in base::OnceCallback&lt;void ()&gt;::Run() &amp;&amp; () at ..&#x2F;..&#x2F;base&#x2F;callback.h:97</span><br><span class="line">#15 base::TaskAnnotator::RunTask () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;task&#x2F;common&#x2F;task_annotator.cc:114</span><br><span class="line">#16 0xc22501f0 in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl ()</span><br><span class="line">    at .&#x2F;..&#x2F;..&#x2F;base&#x2F;task&#x2F;sequence_manager&#x2F;thread_controller_with_message_pump_impl.cc:363</span><br><span class="line">#17 0xc224ff5a in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoSomeWork ()</span><br></pre></td></tr></table></figure>

<p>RenderThread 中 InProcessCommandBuffer建立</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Thread 28 &quot;RenderThread&quot; hit Breakpoint 1, gpu::InProcessCommandBuffer::InProcessCommandBuffer ()</span><br><span class="line">    at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;in_process_command_buffer.cc:285</span><br><span class="line">285     &#125;</span><br><span class="line">(gdb) bt</span><br><span class="line">#0  gpu::InProcessCommandBuffer::InProcessCommandBuffer () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;in_process_command_buffer.cc:285</span><br><span class="line">#1  0xc09722f2 in std::__1::make_unique&lt;gpu::InProcessCommandBuffer, gpu::CommandBufferTaskExecutor*&amp;, GURL&gt;(gpu::CommandBufferTaskExecutor*&amp;, GURL&amp;&amp;) () at ..&#x2F;..&#x2F;buildtools&#x2F;third_party&#x2F;libc++&#x2F;trunk&#x2F;include&#x2F;memory:3131</span><br><span class="line">#2  gpu::GLInProcessContext::Initialize () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;gl_in_process_context.cc:75</span><br><span class="line">#3  0xbf09bf00 in android_webview::AwRenderThreadContextProvider::AwRenderThreadContextProvider ()</span><br><span class="line">    at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_render_thread_context_provider.cc:69</span><br><span class="line">#4  android_webview::AwRenderThreadContextProvider::Create () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_render_thread_context_provider.cc:32</span><br><span class="line">#5  0xbf0a25f4 in android_webview::SurfacesInstance::SurfacesInstance () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;surfaces_instance.cc:129</span><br><span class="line">#6  android_webview::SurfacesInstance::GetOrCreateInstance () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;surfaces_instance.cc:55</span><br><span class="line">#7  0xbf09f3e4 in android_webview::HardwareRenderer::HardwareRenderer () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;hardware_renderer.cc:33</span><br><span class="line">#8  0xbf0a0f4c in android_webview::RenderThreadManager::DrawOnRT () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;render_thread_manager.cc:203</span><br><span class="line">#9  0xbf09a31a in android_webview::AwDrawFnImpl::DrawInternal&lt;AwDrawFn_DrawGLParams&gt; ()</span><br><span class="line">    at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:624</span><br><span class="line">#10 android_webview::AwDrawFnImpl::DrawGL () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:275</span><br><span class="line">#11 android_webview::(anonymous namespace)::DrawGLWrapper () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:133</span><br><span class="line">#12 0xe0d68262 in android::(anonymous namespace)::draw_gl(int, void*, android::uirenderer::DrawGlInfo const&amp;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libwebviewchromium_plat_support.so</span><br><span class="line">#13 0xebb53e20 in android::uirenderer::WebViewFunctor::drawGl(android::uirenderer::DrawGlInfo const&amp;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#14 0xebb5356e in android::uirenderer::skiapipeline::GLFunctorDrawable::onDraw(SkCanvas*) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#15 0xeba7a024 in SkCanvas::onDrawDrawable(SkDrawable*, SkMatrix const*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#16 0xeba725f4 in android::uirenderer::skiapipeline::RenderNodeDrawable::drawContent(SkCanvas*) const ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#17 0xeba98a42 in android::uirenderer::skiapipeline::RenderNodeDrawable::forceDraw(SkCanvas*) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#18 0xeba9dcc8 in android::uirenderer::skiapipeline::SkiaPipeline::renderLayersImpl(android::uirenderer::LayerUpdateQueue const&amp;, bool) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#19 0xeba9be44 in android::uirenderer::skiapipeline::SkiaPipeline::renderFrame(android::uirenderer::LayerUpdateQueue const&amp;, SkRect const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, bool, android::uirenderer::Rect const&amp;, sk_sp&lt;SkSurface&gt;, SkMatrix const&amp;) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br></pre></td></tr></table></figure>
<p>GPU线程 创建 SharedImageFactory</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#0  gpu::SharedImageFactory::SharedImageFactory ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;shared_image_factory.cc:96</span><br><span class="line">#1  0xc0993164 in std::__1::make_unique&lt;gpu::SharedImageFactory, gpu::GpuPreferences const&amp;, gpu::GpuDriverBugWorkarounds const&amp;, gpu::GpuFeatureInfo const&amp;, gpu::SharedContextState*, gpu::MailboxManager*, gpu::SharedImageManager*, gpu::ImageFactory*, gpu::SharedImageStub*, bool&gt;(gpu::GpuPreferences const&amp;, gpu::GpuDriverBugWorkarounds const&amp;, gpu::GpuFeatureInfo const&amp;, gpu::SharedContextState*&amp;&amp;, gpu::MailboxManager*&amp;&amp;, gpu::SharedImageManager*&amp;&amp;, gpu::ImageFactory*&amp;&amp;, gpu::SharedImageStub*&amp;&amp;, bool&amp;&amp;) ()</span><br><span class="line">    at ..&#x2F;..&#x2F;buildtools&#x2F;third_party&#x2F;libc++&#x2F;trunk&#x2F;include&#x2F;memory:3131</span><br><span class="line">#2  gpu::SharedImageStub::MakeContextCurrentAndCreateFactory () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;shared_image_stub.cc:310</span><br><span class="line">#3  0xc0990360 in gpu::SharedImageStub::Create () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;shared_image_stub.cc:51</span><br><span class="line">#4  gpu::GpuChannel::CreateSharedImageStub () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel.cc:598</span><br><span class="line">#5  gpu::GpuChannel::Create () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel.cc:432</span><br><span class="line">#6  gpu::GpuChannelManager::EstablishChannel () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;gpu_channel_manager.cc:171</span><br><span class="line">#7  0xbf485426 in viz::GpuServiceImpl::EstablishGpuChannel(int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;) () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;gl&#x2F;gpu_service_impl.cc:648</span><br><span class="line">#8  0xbf4887a4 in base::internal::FunctorTraits&lt;void (viz::GpuServiceImpl::*)(int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;), void&gt;::Invoke&lt;void (viz::GpuServiceImpl::*)(int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;), base::WeakPtr&lt;viz::GpuServiceImpl&gt;, int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt; &gt;(void (viz::GpuServiceImpl::*)(int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;), base::WeakPtr&lt;viz::GpuServiceImpl&gt;&amp;&amp;, int&amp;&amp;, unsigned long long&amp;&amp;, bool&amp;&amp;, bool&amp;&amp;, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:499</span><br><span class="line">#9  base::internal::InvokeHelper&lt;true, void&gt;::MakeItSo&lt;void (viz::GpuServiceImpl::*)(int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;), base::WeakPtr&lt;viz::GpuServiceImpl&gt;, int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt; &gt;(void (viz::GpuServiceImpl::*&amp;&amp;)(int, unsigned long long, bool, bool, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;), base::WeakPtr&lt;viz::GpuServiceImpl&gt;&amp;&amp;, int&amp;&amp;, unsigned long long&amp;&amp;, bool&amp;&amp;, bool&amp;&amp;, base::OnceCallback&lt;void (mojo::ScopedHandleBase&lt;mojo::MessagePipeHandle&gt;)&gt;&amp;&amp;) () at ..&#x2F;..&#x2F;base&#x2F;bind_internal.h:619</span><br></pre></td></tr></table></figure>
<p>UI线程创建GPUchannel</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#0  viz::GpuClient::PreEstablishGpuChannel () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;host&#x2F;gpu_client.cc:66</span><br><span class="line">#1  0xbf5d79dc in content::RenderProcessHostImpl::Init () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;renderer_host&#x2F;render_process_host_impl.cc:1822</span><br><span class="line">#2  0xbf53f5cc in content::RenderFrameHostManager::InitRenderView () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;render_frame_host_manager.cc:2087</span><br><span class="line">#3  0xbf53e7a4 in content::RenderFrameHostManager::ReinitializeRenderFrame ()</span><br><span class="line">    at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;render_frame_host_manager.cc:2253</span><br><span class="line">#4  0xbf53dc44 in content::RenderFrameHostManager::GetFrameHostForNavigation ()</span><br><span class="line">    at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;render_frame_host_manager.cc:740</span><br><span class="line">#5  0xbf53d9fc in content::RenderFrameHostManager::DidCreateNavigationRequest ()</span><br><span class="line">    at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;render_frame_host_manager.cc:574</span><br><span class="line">#6  0xbf5102b6 in content::FrameTreeNode::CreatedNavigationRequest () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;frame_tree_node.cc:430</span><br><span class="line">#7  0xbf5299d0 in content::NavigatorImpl::Navigate () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;navigator_impl.cc:346</span><br><span class="line">#8  0xbf51da24 in content::NavigationControllerImpl::NavigateWithoutEntry ()</span><br><span class="line">    at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;navigation_controller_impl.cc:2878</span><br><span class="line">#9  content::NavigationControllerImpl::LoadURLWithParams () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;navigation_controller_impl.cc:973</span><br><span class="line">#10 0xbf512bac in content::NavigationControllerAndroid::LoadUrl () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;browser&#x2F;frame_host&#x2F;navigation_controller_android.cc:294</span><br><span class="line">#11 Java_com_bytedance_org_chromium_content_browser_framehost_NavigationControllerImpl_nativeLoadUrl ()</span><br><span class="line">    at gen&#x2F;content&#x2F;public&#x2F;android&#x2F;content_jni_headers&#x2F;content&#x2F;jni&#x2F;NavigationControllerImpl_jni.h:241</span><br></pre></td></tr></table></figure>
<p>GPU线程创建MailboxManagerSync</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#0  gpu::gles2::CreateMailboxManager () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;mailbox_manager_factory.cc:17</span><br><span class="line">#1  0xbf04696c in android_webview::DeferredGpuCommandService::CreateDeferredGpuCommandService ()</span><br><span class="line">    at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;deferred_gpu_command_service.cc:135</span><br><span class="line">#2  android_webview::DeferredGpuCommandService::GetInstance () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;deferred_gpu_command_service.cc:148</span><br><span class="line">#3  0xbf03abe6 in android_webview::(anonymous namespace)::GetSyncPointManager () at ..&#x2F;..&#x2F;android_webview&#x2F;lib&#x2F;aw_main_delegate.cc:379</span><br><span class="line">#4  0xc130f834 in content::(anonymous namespace)::CreateVizMainDependencies () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;gpu&#x2F;gpu_child_thread.cc:172</span><br><span class="line">#5  content::GpuChildThread::GpuChildThread(base::RepeatingCallback&lt;void ()&gt;, content::ChildThreadImpl::Options const&amp;, std::__1::unique_ptr&lt;gpu::GpuInit, std::__1::default_delete&lt;gpu::GpuInit&gt; &gt;) () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;gpu&#x2F;gpu_child_thread.cc:209</span><br><span class="line">#6  0xc1310abc in content::GpuChildThread::GpuChildThread () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;gpu&#x2F;gpu_child_thread.cc:196</span><br><span class="line">#7  content::InProcessGpuThread::Init () at .&#x2F;..&#x2F;..&#x2F;content&#x2F;gpu&#x2F;in_process_gpu_thread.cc:59</span><br><span class="line">#8  0xbfdb7a52 in base::Thread::ThreadMain () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;threading&#x2F;thread.cc:301</span><br><span class="line">#9  0xbfddb234 in base::(anonymous namespace)::ThreadFunc () at .&#x2F;..&#x2F;..&#x2F;base&#x2F;threading&#x2F;platform_thread_posix.cc:81</span><br></pre></td></tr></table></figure>
<p>RenderThread创建AwGLSurface</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#0  gpu::InProcessCommandBuffer::Initialize () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;in_process_command_buffer.cc:347</span><br><span class="line">#1  0xbe42f34c in gpu::GLInProcessContext::Initialize () at ..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;gl_in_process_context.cc:78</span><br><span class="line">#2  0xbcb58f00 in android_webview::AwRenderThreadContextProvider::AwRenderThreadContextProvider ()</span><br><span class="line">    at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_render_thread_context_provider.cc:69</span><br><span class="line">#3  android_webview::AwRenderThreadContextProvider::Create () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_render_thread_context_provider.cc:32</span><br><span class="line">#4  0xbcb5f5f4 in android_webview::SurfacesInstance::SurfacesInstance () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;surfaces_instance.cc:129</span><br><span class="line">#5  android_webview::SurfacesInstance::GetOrCreateInstance () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;surfaces_instance.cc:55</span><br><span class="line">#6  0xbcb5c3e4 in android_webview::HardwareRenderer::HardwareRenderer () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;hardware_renderer.cc:33</span><br><span class="line">#7  0xbcb5df4c in android_webview::RenderThreadManager::DrawOnRT () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;render_thread_manager.cc:203</span><br><span class="line">#8  0xbcb5731a in android_webview::AwDrawFnImpl::DrawInternal&lt;AwDrawFn_DrawGLParams&gt; () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:624</span><br><span class="line">#9  android_webview::AwDrawFnImpl::DrawGL () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:275</span><br><span class="line">#10 android_webview::(anonymous namespace)::DrawGLWrapper () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:133</span><br><span class="line">#11 0xde1b6262 in android::(anonymous namespace)::draw_gl(int, void*, android::uirenderer::DrawGlInfo const&amp;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libwebviewchromium_plat_support.so</span><br><span class="line">#12 0xe79f2e20 in android::uirenderer::WebViewFunctor::drawGl(android::uirenderer::DrawGlInfo const&amp;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#13 0xe79f256e in android::uirenderer::skiapipeline::GLFunctorDrawable::onDraw(SkCanvas*) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#14 0xe7919024 in SkCanvas::onDrawDrawable(SkDrawable*, SkMatrix const*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#15 0xe79115f4 in android::uirenderer::skiapipeline::RenderNodeDrawable::drawContent(SkCanvas*) const ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#16 0xe7937a42 in android::uirenderer::skiapipeline::RenderNodeDrawable::forceDraw(SkCanvas*) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#17 0xe793ccc8 in android::uirenderer::skiapipeline::SkiaPipeline::renderLayersImpl(android::uirenderer::LayerUpdateQueue const&amp;, bool) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#18 0xe793ae44 in android::uirenderer::skiapipeline::SkiaPipeline::renderFrame(android::uirenderer::LayerUpdateQueue const&amp;, SkRect const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, bool, android::uirenderer::Rect const&amp;, sk_sp&lt;SkSurface&gt;, SkMatrix const&amp;) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#19 0xe793abc0 in android::uirenderer::skiapipeline::SkiaOpenGLPipeline::draw(android::uirenderer::renderthread::Frame const&amp;, SkRect const&amp;, SkRect const&amp;, android::uirenderer::LightGeometry const&amp;, android::uirenderer::LayerUpdateQueue*, android::uirenderer::Rect const&amp;, bool, android::uirenderer::LightInfo const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, android::uirenderer::FrameInfoVisualizer*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#20 0xe7979df6 in android::uirenderer::renderthread::CanvasContext::draw() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#21 0xe79793de in std::__1::__function::__func&lt;android::uirenderer::renderthread::DrawFrameTask::postAndWait()::$_0, std::__1::allocator&lt;android::uirenderer::renderthread::DrawFrameTask::postAndWait()::$_0&gt;, void ()&gt;::operator() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#22 0xe7986cd0 in android::uirenderer::WorkQueue::process() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#23 0xe7986b2a in android::uirenderer::renderthread::RenderThread::threadLoop() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#24 0xe6d2689a in android::Thread::_threadLoop(void*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libutils.so</span><br></pre></td></tr></table></figure>
<p>RenderThread 回放DrawQuad</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#0  gpu::gles2::GLES2Implementation::CreateAndConsumeTextureCHROMIUM () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;client&#x2F;gles2_implementation.cc:6433</span><br><span class="line">#1  0xbd3a8ade in viz::DisplayResourceProvider::LockForRead () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;display_resource_provider.cc:478</span><br><span class="line">#2  0xbd3b0d54 in viz::DisplayResourceProvider::ScopedReadLockGL::ScopedReadLockGL () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;display_resource_provider.cc:843</span><br><span class="line">#3  viz::DisplayResourceProvider::ScopedSamplerGL::ScopedSamplerGL () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;display_resource_provider.cc:864</span><br><span class="line">#4  viz::GLRenderer::DrawContentQuadNoAA () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;gl_renderer.cc:2105</span><br><span class="line">#5  viz::GLRenderer::DrawContentQuad () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;gl_renderer.cc:1971</span><br><span class="line">#6  viz::GLRenderer::DrawTileQuad () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;gl_renderer.cc:1938</span><br><span class="line">#7  viz::GLRenderer::DoDrawQuad () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;gl_renderer.cc:533</span><br><span class="line">#8  0xbd3a0886 in viz::DirectRenderer::DrawRenderPass () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;direct_renderer.cc:714</span><br><span class="line">#9  viz::DirectRenderer::DrawRenderPassAndExecuteCopyRequests () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;direct_renderer.cc:573</span><br><span class="line">#10 0xbd3a6ea0 in viz::DirectRenderer::DrawFrame () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;direct_renderer.cc:429</span><br><span class="line">#11 viz::Display::DrawAndSwap () at .&#x2F;..&#x2F;..&#x2F;components&#x2F;viz&#x2F;service&#x2F;display&#x2F;display.cc:492</span><br><span class="line">#12 0xbbc04b6e in android_webview::SurfacesInstance::DrawAndSwap () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;surfaces_instance.cc:239</span><br><span class="line">#13 0xbbc01e48 in android_webview::HardwareRenderer::Draw () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;hardware_renderer.cc:197</span><br><span class="line">#14 0xbbc0301a in android_webview::RenderThreadManager::DrawOnRT () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;render_thread_manager.cc:208</span><br><span class="line">#15 0xbbbfc3ca in android_webview::AwDrawFnImpl::DrawInternal&lt;AwDrawFn_DrawGLParams&gt; () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:624</span><br><span class="line">#16 android_webview::AwDrawFnImpl::DrawGL () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:275</span><br><span class="line">#17 android_webview::(anonymous namespace)::DrawGLWrapper () at ..&#x2F;..&#x2F;android_webview&#x2F;browser&#x2F;gfx&#x2F;aw_draw_fn_impl.cc:133</span><br><span class="line">#18 0xdd5e5262 in android::(anonymous namespace)::draw_gl(int, void*, android::uirenderer::DrawGlInfo const&amp;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libwebviewchromium_plat_support.so</span><br><span class="line">#19 0xe8712e20 in android::uirenderer::WebViewFunctor::drawGl(android::uirenderer::DrawGlInfo const&amp;) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#20 0xe871256e in android::uirenderer::skiapipeline::GLFunctorDrawable::onDraw(SkCanvas*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#21 0xe8639024 in SkCanvas::onDrawDrawable(SkDrawable*, SkMatrix const*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#22 0xe86315f4 in android::uirenderer::skiapipeline::RenderNodeDrawable::drawContent(SkCanvas*) const ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#23 0xe8657a42 in android::uirenderer::skiapipeline::RenderNodeDrawable::forceDraw(SkCanvas*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#24 0xe865ccc8 in android::uirenderer::skiapipeline::SkiaPipeline::renderLayersImpl(android::uirenderer::LayerUpdateQueue const&amp;, bool) ()</span><br><span class="line">   from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#25 0xe865ae44 in android::uirenderer::skiapipeline::SkiaPipeline::renderFrame(android::uirenderer::LayerUpdateQueue const&amp;, SkRect const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, bool, android::uirenderer::Rect const&amp;, sk_sp&lt;SkSurface&gt;, SkMatrix const&amp;) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#26 0xe865abc0 in android::uirenderer::skiapipeline::SkiaOpenGLPipeline::draw(android::uirenderer::renderthread::Frame const&amp;, SkRect const&amp;, SkRect const&amp;, android::uirenderer::LightGeometry const&amp;, android::uirenderer::LayerUpdateQueue*, android::uirenderer::Rect const&amp;, bool, android::uirenderer::LightInfo const&amp;, std::__1::vector&lt;android::sp&lt;android::uirenderer::RenderNode&gt;, std::__1::allocator&lt;android::sp&lt;android::uirenderer::RenderNode&gt; &gt; &gt; const&amp;, android::uirenderer::FrameInfoVisualizer*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#27 0xe8699df6 in android::uirenderer::renderthread::CanvasContext::draw() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#28 0xe86993de in std::__1::__function::__func&lt;android::uirenderer::renderthread::DrawFrameTask::postAndWait()::$_0, std::__1::allocator&lt;android::uirenderer::renderthread::DrawFrameTask::postAndWait()::$_0&gt;, void ()&gt;::operator() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#29 0xe86a6cd0 in android::uirenderer::WorkQueue::process() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#30 0xe86a6b2a in android::uirenderer::renderthread::RenderThread::threadLoop() () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libhwui.so</span><br><span class="line">#31 0xe8ca889a in android::Thread::_threadLoop(void*) () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libutils.so</span><br></pre></td></tr></table></figure>
<p>GPU thread 用skia 绘制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#0  0xe6692354 in glDrawElements () from &#x2F;tmp&#x2F;adb-gdb-libs-99121FFAZ00A7P&#x2F;system&#x2F;lib&#x2F;libGLESv2.so</span><br><span class="line">#1  0xbcefdbcc in GrGLGpu::sendIndexedMeshToGpu () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;include&#x2F;gpu&#x2F;gl&#x2F;GrGLFunctions.h:303</span><br><span class="line">#2  0xbcefdc2e in non-virtual thunk to GrGLGpu::sendIndexedMeshToGpu(GrPrimitiveType, GrBuffer const*, int, int, unsigned short, unsigned short, GrBuffer const*, int, GrPrimitiveRestart) () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;include&#x2F;gpu&#x2F;gl&#x2F;GrGLFunctions.h:303</span><br><span class="line">#3  0xbcefda84 in GrMesh::sendToGpu () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrMesh.h:246</span><br><span class="line">#4  0xbcefd92e in GrGLGpu::draw () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;gl&#x2F;GrGLGpu.cpp:2624</span><br><span class="line">#5  0xbcf015ac in GrGLGpuRTCommandBuffer::onDraw () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;gl&#x2F;GrGLGpuCommandBuffer.h:88</span><br><span class="line">#6  0xbce88cda in GrGpuRTCommandBuffer::draw () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrGpuCommandBuffer.cpp:101</span><br><span class="line">#7  0xbce8a232 in GrOpFlushState::executeDrawsAndUploadsForMeshDrawOp(GrOp const*, SkRect const&amp;, GrProcessorSet&amp;&amp;, GrPipeline::InputFlags, GrUserStencilSettings const*) () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrOpFlushState.cpp:56</span><br><span class="line">#8  0xbced1f7a in GrSimpleMeshDrawOpHelper::executeDrawsAndUploads () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;ops&#x2F;GrSimpleMeshDrawOpHelper.cpp:109</span><br><span class="line">#9  0xbce9c79c in GrOp::execute () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;ops&#x2F;GrOp.h:181</span><br><span class="line">#10 0xbce9c6a0 in GrRenderTargetOpList::onExecute () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrRenderTargetOpList.cpp:512</span><br><span class="line">#11 0xbce8308a in GrOpList::execute () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;include&#x2F;private&#x2F;GrOpList.h:41</span><br><span class="line">#12 GrDrawingManager::executeOpLists () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrDrawingManager.cpp:496</span><br><span class="line">#13 GrDrawingManager::flush () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrDrawingManager.cpp:357</span><br><span class="line">#14 0xbce83464 in GrDrawingManager::flushSurfaces () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrDrawingManager.cpp:575</span><br><span class="line">#15 0xbce9b1dc in GrDrawingManager::flushSurface () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrDrawingManager.h:89</span><br><span class="line">#16 GrRenderTargetContext::flush () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;gpu&#x2F;GrRenderTargetContext.cpp:1757</span><br><span class="line">#17 0xbbdb209a in SkSurface::flush () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;image&#x2F;SkSurface.cpp:247</span><br><span class="line">---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---</span><br><span class="line">#18 SkSurface::flush () at ..&#x2F;..&#x2F;third_party&#x2F;skia&#x2F;src&#x2F;image&#x2F;SkSurface.cpp:243</span><br><span class="line">#19 0xbd4dc312 in gpu::raster::RasterDecoderImpl::DoEndRasterCHROMIUM ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;raster_decoder.cc:2193</span><br><span class="line">#20 gpu::raster::RasterDecoderImpl::HandleEndRasterCHROMIUM () at ..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;raster_decoder_autogen.h:157</span><br><span class="line">#21 0xbd4df1a6 in gpu::raster::RasterDecoderImpl::DoCommandsImpl&lt;false&gt; ()</span><br><span class="line">    at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;raster_decoder.cc:1184</span><br><span class="line">#22 gpu::raster::RasterDecoderImpl::DoCommands () at ..&#x2F;..&#x2F;third_party&#x2F;mesa_headers&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;raster_decoder.cc:1243</span><br><span class="line">#23 0xbd3a25a0 in gpu::CommandBufferService::Flush () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;command_buffer&#x2F;service&#x2F;command_buffer_service.cc:69</span><br><span class="line">#24 0xbd53d160 in gpu::CommandBufferStub::OnAsyncFlush () at .&#x2F;..&#x2F;..&#x2F;gpu&#x2F;ipc&#x2F;service&#x2F;command_buffer_stub.cc:522</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bathingsun.xyz/2020/09/22/Android-WebView-DrawFn-%E7%9B%B8%E5%85%B3/" data-id="ckhk36rdh0000frs32afu3kfl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/10/16/%E8%A7%84%E5%88%99%E5%8C%B9%E9%85%8D%E5%BC%95%E6%93%8E/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          规则匹配引擎
        
      </div>
    </a>
  
  
    <a href="/2020/01/01/Media-%E7%9B%B8%E5%85%B3-Tips/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Media 相关 Tips</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/10/%E5%A6%82%E4%BD%95%E8%B0%83%E6%95%99%E4%B8%80%E5%8F%B0%E5%AE%8C%E7%BE%8E%E6%B5%8B%E8%AF%95%E6%9C%BA/">如何调教一台完美的测试机:AOSP刷入GMS记录</a>
          </li>
        
          <li>
            <a href="/2020/10/16/%E8%A7%84%E5%88%99%E5%8C%B9%E9%85%8D%E5%BC%95%E6%93%8E/">规则匹配引擎</a>
          </li>
        
          <li>
            <a href="/2020/09/22/Android-WebView-DrawFn-%E7%9B%B8%E5%85%B3/">Android WebView DrawFn 相关</a>
          </li>
        
          <li>
            <a href="/2020/01/01/Media-%E7%9B%B8%E5%85%B3-Tips/">Media 相关 Tips</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 MonkD404<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>